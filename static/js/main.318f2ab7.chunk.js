(this.webpackJsonpschedule=this.webpackJsonpschedule||[]).push([[0],{487:function(e,t,a){},488:function(e,t,a){"use strict";a.r(t);var n=a(7),r=a.n(n),c=a(37),s=a.n(c),i=a(15),o=a(18),l=a(17),d=a(16),u=a(8),f=a(14),m=a.n(f),p=a(23),j=a(490),h=a(19),v=a(38),b=a.n(v),O=a(13),g=a.n(O),_=a(4),k=function(e){return Object(_.jsx)("a",{className:e.className,href:e.to,target:e.newTab?"_blank":"",rel:"noopener noreferrer",children:e.children})},y=function(e){return e&&e.toLowerCase().replace(/\u0451/g,"\u0435").replace(/[^\u0430-\u044f]/g,"")},I=function(e,t){return Array.from(e.getElementsByTagName(t))[0]},x=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).init=Object(p.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.loadDates();case 2:n.parseSpekts(),n.tryFindImgs();case 4:case"end":return e.stop()}}),e)}))),n.loadDates=Object(p.a)(m.a.mark((function e(){var t,a,r,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("https://apit.bileter.ru/8e665805311706860c2ef141d3dc13e2/afisha?json=1");case 2:t=e.sent.data,a=t[Object.keys(t)[0]],r={},c=[],g.a.forOwn(a,(function(e,t){e.forEach((function(e){var a=e.PerfDate.split(" ")[0].split("."),n=e.PerfDate.split(" ")[1],c="".concat(a[1],"/").concat(a[0],"/").concat(a[2]," ").concat(n);r[t]||(r[t]=[]),r[t].push(Object(u.a)(Object(u.a)({},e),{},{PerfDate:c}))}))})),g.a.values(r).map((function(e){return e.map((function(e){return c.push(e)}))})),n.setState({dates:r,performances:c});case 8:case"end":return e.stop()}}),e)}))),n.parseSpekts=function(){var e=n.state.dates,t={};g.a.forOwn(e,(function(e){return g.a.forOwn(e,(function(e){var a=e.PerfDate.split(" ")[0],n=e.PerfDate.split(" ")[1].slice(0,5);if(t.hasOwnProperty(e.Name)){var r=t[e.Name][t[e.Name].length-1];r.PerfDate===a?r.time.push(n):t[e.Name].push(Object(u.a)(Object(u.a)({},e),{},{PerfDate:a,time:[n]}))}else t[e.Name]=[Object(u.a)(Object(u.a)({},e),{},{PerfDate:a,time:[n]})]}))})),n.setState({spekts:t})},n.tryFindImgs=function(){n.tryFindImgsInterval||(n.tryFindImgsInterval=setInterval(n.tryFindImgs,100));var e=document.getElementsByClassName("category-performance"),t=n.state.tryCount;if(t>100)return console.log("imgs wasn't found after ".concat(t," tries")),clearInterval(n.tryFindImgsInterval),void(n.tryFindImgsInterval=void 0);0!==e.length?(console.log("imgs found after ".concat(t," tries")),clearInterval(n.tryFindImgsInterval),n.tryFindImgsInterval=void 0,Array.from(e).forEach((function(e){var t=I(I(e,"h2"),"a").href,a=I(I(e,"h2"),"a").innerText,r=I(e,"img").src;n.setState({additionalData:Object(u.a)(Object(u.a)({},n.state.additionalData),{},Object(d.a)({},y(a),{img:r,to:t}))})}))):n.setState({tryCount:t+1})},n.renderHeadline=function(){return Object(_.jsxs)("h2",{className:"cmsmasters_heading",children:["\u0421\u043c\u043e\u0442\u0440\u0438\u0442\u0435 \u0432 ",Object(_.jsx)(k,{to:"https://nebdt.ru/afisha/",children:function(){var e=Object(j.a)(new Date,"MMMM",{locale:h.ru});return"\u0442"===e.slice(-1)?e:e.slice(0,-1)+"\u0435"}()})]})},n.renderItem=function(e,t){var a,r;return Object(_.jsxs)("div",{className:"lev-schedule__spekt",children:[Object(_.jsxs)(k,{className:"lev-schedule__spekt__to",to:null===(a=n.state.additionalData[y(e.Name)])||void 0===a?void 0:a.to,children:[Object(_.jsx)("img",{className:"lev-schedule__spekt__to__img",src:(null===(r=n.state.additionalData[y(e.Name)])||void 0===r?void 0:r.img)||""}),Object(_.jsx)("div",{className:"lev-schedule__spekt__to__name",children:e.Name}),Object(_.jsxs)("div",{className:"lev-schedule__spekt__to__dates",children:["spekt"===t?e.map((function(e){var t=new Date(e.PerfDate),a=e.time.reduce((function(e,t){return e+", "+t})).replace(/\,(?!.*\,)/," \u0438");return Object(j.a)(t,"dd, iiii, ".concat(a),{locale:h.ru})})).reduce((function(e,t){return e+" / "+t})):Object(j.a)(new Date(e.PerfDate),"dd, iiii, HH:mm",{locale:h.ru})," / ",function(){var a="spekt"===t?e[0]:e,n=a.BuildingName,r=a.HallName,c=n.indexOf("("),s=n.indexOf(")");return-1!==c&&-1!==s?n.slice(c+1,s):r}()]})]}),"spekt"!==t&&Object(_.jsx)("div",{className:"lev-schedule__spekt__button with_buy bileter_afisha_showhall",id:"perf".concat(e.IdPerformance),children:"\u041a\u0443\u043f\u0438\u0442\u044c \u0431\u0438\u043b\u0435\u0442"})]},e.IdPerformance)},n.renderSpekts=function(){return Object.keys(n.state.spekts)&&g.a.values(n.state.spekts).map((function(e){return n.renderItem(e,"spekt")}))},n.renderPerformances=function(){return n.state.performances.slice(0,6).map((function(e){return n.renderItem(e)}))},n.render=function(){return Object(_.jsxs)(_.Fragment,{children:[n.renderHeadline(),Object(_.jsx)("div",{className:"lev-schedule",children:n.renderPerformances()})]})},n.state={dates:{},spekts:{},performances:[],additionalData:{},tryCount:0},n.init(),n}return a}(r.a.Component),N=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).render=function(){return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("div",{id:"react-injected-div"}),Object(_.jsx)(x,{})]})},e}return a}(n.Component);a(487);s.a.render(Object(_.jsx)(r.a.StrictMode,{children:Object(_.jsx)(N,{})}),document.getElementById("root"))}},[[488,1,2]]]);
//# sourceMappingURL=main.318f2ab7.chunk.js.map